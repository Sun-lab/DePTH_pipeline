
R version 4.1.0 (2021-05-18) -- "Camp Pontanezen"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # this code computes distance matrices for HLAs, based on predicted scores
> # from Glazer 2022 model on server on the pairs between Zheng 2021 tcrs and
> # HLAs
> 
> 
> # distance based on positive TCRs from single cell data
> 
> pos_filename = "st8_Glazer_2022_server_on_zheng_2021_pos_extended_hlas_146.csv" 
> df_pos = read.csv(paste0("../results/", pos_filename), header = TRUE)
> dim(df_pos)
[1] 10008   146
> head(df_pos)
      A0101     A0102     A0103     A0201     A0202     A0203     A0205
1 0.5186774 0.5186774 0.5186774 0.9272094 0.4056151 0.8726743 0.8846783
2 0.5186774 0.5186774 0.5186774 0.9272094 0.4056151 0.8726743 0.8846783
3 0.5186774 0.5186774 0.5186774 0.9272094 0.4056151 0.8726743 0.8846783
4 0.5186774 0.5186774 0.5186774 0.9272094 0.4056151 0.8726743 0.8846783
5 0.5186774 0.5186774 0.5186774 0.9272094 0.4056151 0.8726743 0.8846783
6 0.5186774 0.5186774 0.5186774 0.9272094 0.4056151 0.8726743 0.8846783
      A0206     A0207     A0217     A0301     A0302     A0305     A1101
1 0.8418347 0.8819703 0.8392178 0.5369058 0.1535113 0.3940677 0.3529213
2 0.8418347 0.8819703 0.8392178 0.5369058 0.1535113 0.3940677 0.3529213
3 0.8418347 0.8819703 0.8392178 0.5369058 0.1535113 0.3940677 0.3529213
4 0.8418347 0.8819703 0.8392178 0.5369058 0.1535113 0.3940677 0.3529213
5 0.8418347 0.8819703 0.8392178 0.5369058 0.1535113 0.3940677 0.3529213
6 0.8418347 0.8819703 0.8392178 0.5369058 0.1535113 0.3940677 0.3529213
      A1102     A1104     A2301     A2402     A2403     A2407     A2421
1 0.3529213 0.3529213 0.5890822 0.1616679 0.1616679 0.1616679 0.1616679
2 0.3529213 0.3529213 0.5890822 0.1616679 0.1616679 0.1616679 0.1616679
3 0.3529213 0.3529213 0.5890822 0.1616679 0.1616679 0.1616679 0.1616679
4 0.3529213 0.3529213 0.5890822 0.1616679 0.1616679 0.1616679 0.1616679
5 0.3529213 0.3529213 0.5890822 0.1616679 0.1616679 0.1616679 0.1616679
6 0.3529213 0.3529213 0.5890822 0.1616679 0.1616679 0.1616679 0.1616679
      A2426     A2501     A2601     A2602     A2608     A2901     A2902
1 0.1616679 0.7014886 0.7562637 0.1182342 0.5426104 0.6407576 0.1015859
2 0.1616679 0.7014886 0.7562637 0.1182342 0.5426104 0.6407576 0.1015859
3 0.1616679 0.7014886 0.7562637 0.1182342 0.5426104 0.6407576 0.1015859
4 0.1616679 0.7014886 0.7562637 0.1182342 0.5426104 0.6407576 0.1015859
5 0.1616679 0.7014886 0.7562637 0.1182342 0.5426104 0.6407576 0.1015859
6 0.1616679 0.7014886 0.7562637 0.1182342 0.5426104 0.6407576 0.1015859
      A3001     A3002     A3004     A3010     A3101     A3201     A3301
1 0.4938821 0.1013758 0.3896892 0.1507915 0.4621004 0.8813003 0.4519513
2 0.4938821 0.1013758 0.3896892 0.1507915 0.4621004 0.8813003 0.4519513
3 0.4938821 0.1013758 0.3896892 0.1507915 0.4621004 0.8813003 0.4519513
4 0.4938821 0.1013758 0.3896892 0.1507915 0.4621004 0.8813003 0.4519513
5 0.4938821 0.1013758 0.3896892 0.1507915 0.4621004 0.8813003 0.4519513
6 0.4938821 0.1013758 0.3896892 0.1507915 0.4621004 0.8813003 0.4519513
     A3303     A3401     A3402  A6601      A6602     A6801      A6802    A6810
1 0.135507 0.5271835 0.1948136 0.7123 0.08654357 0.7409384 0.08652922 0.305847
2 0.135507 0.5271835 0.1948136 0.7123 0.08654357 0.7409384 0.08652922 0.305847
3 0.135507 0.5271835 0.1948136 0.7123 0.08654357 0.7409384 0.08652922 0.305847
4 0.135507 0.5271835 0.1948136 0.7123 0.08654357 0.7409384 0.08652922 0.305847
5 0.135507 0.5271835 0.1948136 0.7123 0.08654357 0.7409384 0.08652922 0.305847
6 0.135507 0.5271835 0.1948136 0.7123 0.08654357 0.7409384 0.08652922 0.305847
      B0702     B0704     B0705    B0801     B1301     B1302     B1401
1 0.2709411 0.3668716 0.3668716 0.563864 0.3046181 0.1628118 0.5024624
2 0.2709411 0.3668716 0.3668716 0.563864 0.3046181 0.1628118 0.5024624
3 0.2709411 0.3668716 0.3668716 0.563864 0.3046181 0.1628118 0.5024624
4 0.2709411 0.3668716 0.3668716 0.563864 0.3046181 0.1628118 0.5024624
5 0.2709411 0.3668716 0.3668716 0.563864 0.3046181 0.1628118 0.5024624
6 0.2709411 0.3668716 0.3668716 0.563864 0.3046181 0.1628118 0.5024624
      B1402     B1501     B1502     B1503     B1505     B1507     B1508
1 0.5024624 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
2 0.5024624 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
3 0.5024624 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
4 0.5024624 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
5 0.5024624 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
6 0.5024624 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
      B1509     B1510     B1512     B1516     B1517     B1518     B1525
1 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
2 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
3 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
4 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
5 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
6 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087 0.2813087
      B1527     B1801     B1803     B2702     B2703     B2704     B2705
1 0.2813087 0.3743338 0.1185997 0.5380297 0.5380297 0.5380297 0.4786293
2 0.2813087 0.3743338 0.1185997 0.5380297 0.5380297 0.5380297 0.4786293
3 0.2813087 0.3743338 0.1185997 0.5380297 0.5380297 0.5380297 0.4786293
4 0.2813087 0.3743338 0.1185997 0.5380297 0.5380297 0.5380297 0.4786293
5 0.2813087 0.3743338 0.1185997 0.5380297 0.5380297 0.5380297 0.4786293
6 0.2813087 0.3743338 0.1185997 0.5380297 0.5380297 0.5380297 0.4786293
      B3501      B3502     B3503     B3505     B3508     B3701     B3801
1 0.4148091 0.09845243 0.4148091 0.4148091 0.4148091 0.5276899 0.6813359
2 0.4148091 0.09845243 0.4148091 0.4148091 0.4148091 0.5276899 0.6813359
3 0.4148091 0.09845243 0.4148091 0.4148091 0.4148091 0.5276899 0.6813359
4 0.4148091 0.09845243 0.4148091 0.4148091 0.4148091 0.5276899 0.6813359
5 0.4148091 0.09845243 0.4148091 0.4148091 0.4148091 0.5276899 0.6813359
6 0.4148091 0.09845243 0.4148091 0.4148091 0.4148091 0.5276899 0.6813359
       B3802     B3901      B3902     B3906     B3910     B3924     B4001
1 0.08668377 0.4499073 0.09371381 0.1074459 0.1179035 0.1078511 0.5065567
2 0.08668377 0.4499073 0.09371381 0.1074459 0.1179035 0.1078511 0.5065567
3 0.08668377 0.4499073 0.09371381 0.1074459 0.1179035 0.1078511 0.5065567
4 0.08668377 0.4499073 0.09371381 0.1074459 0.1179035 0.1078511 0.5065567
5 0.08668377 0.4499073 0.09371381 0.1074459 0.1179035 0.1078511 0.5065567
6 0.08668377 0.4499073 0.09371381 0.1074459 0.1179035 0.1078511 0.5065567
      B4002     B4003     B4004     B4006     B4101     B4102     B4402
1 0.1555343 0.2572469 0.4313313 0.2166476 0.3539732 0.1905043 0.2095568
2 0.1555343 0.2572469 0.4313313 0.2166476 0.3539732 0.1905043 0.2095568
3 0.1555343 0.2572469 0.4313313 0.2166476 0.3539732 0.1905043 0.2095568
4 0.1555343 0.2572469 0.4313313 0.2166476 0.3539732 0.1905043 0.2095568
5 0.1555343 0.2572469 0.4313313 0.2166476 0.3539732 0.1905043 0.2095568
6 0.1555343 0.2572469 0.4313313 0.2166476 0.3539732 0.1905043 0.2095568
      B4403     B4405    B4501     B4801     B4901     B5001     B5101
1 0.2095568 0.2095568 0.368753 0.4149569 0.4108056 0.4382674 0.2869675
2 0.2095568 0.2095568 0.368753 0.4149569 0.4108056 0.4382674 0.2869675
3 0.2095568 0.2095568 0.368753 0.4149569 0.4108056 0.4382674 0.2869675
4 0.2095568 0.2095568 0.368753 0.4149569 0.4108056 0.4382674 0.2869675
5 0.2095568 0.2095568 0.368753 0.4149569 0.4108056 0.4382674 0.2869675
6 0.2095568 0.2095568 0.368753 0.4149569 0.4108056 0.4382674 0.2869675
      B5102    B5107     B5108     B5201     B5301     B5501     B5502
1 0.1796336 0.174001 0.1701442 0.8482009 0.4282698 0.4517806 0.1153484
2 0.1796336 0.174001 0.1701442 0.8482009 0.4282698 0.4517806 0.1153484
3 0.1796336 0.174001 0.1701442 0.8482009 0.4282698 0.4517806 0.1153484
4 0.1796336 0.174001 0.1701442 0.8482009 0.4282698 0.4517806 0.1153484
5 0.1796336 0.174001 0.1701442 0.8482009 0.4282698 0.4517806 0.1153484
6 0.1796336 0.174001 0.1701442 0.8482009 0.4282698 0.4517806 0.1153484
      B5601     B5604     B5701     B5702    B5703     B5801      B5802
1 0.5927332 0.5213239 0.3741249 0.3741249 0.132873 0.6082714 0.09196068
2 0.5927332 0.5213239 0.3741249 0.3741249 0.132873 0.6082714 0.09196068
3 0.5927332 0.5213239 0.3741249 0.3741249 0.132873 0.6082714 0.09196068
4 0.5927332 0.5213239 0.3741249 0.3741249 0.132873 0.6082714 0.09196068
5 0.5927332 0.5213239 0.3741249 0.3741249 0.132873 0.6082714 0.09196068
6 0.5927332 0.5213239 0.3741249 0.3741249 0.132873 0.6082714 0.09196068
      C0102     C0103    C0202     C0210     C0302     C0303     C0304
1 0.2122503 0.4153863 0.388494 0.8166167 0.1472918 0.3390591 0.5117161
2 0.2122503 0.4153863 0.388494 0.8166167 0.1472918 0.3390591 0.5117161
3 0.2122503 0.4153863 0.388494 0.8166167 0.1472918 0.3390591 0.5117161
4 0.2122503 0.4153863 0.388494 0.8166167 0.1472918 0.3390591 0.5117161
5 0.2122503 0.4153863 0.388494 0.8166167 0.1472918 0.3390591 0.5117161
6 0.2122503 0.4153863 0.388494 0.8166167 0.1472918 0.3390591 0.5117161
      C0305     C0401     C0403     C0404     C0501      C0602    C0701
1 0.3777376 0.3821031 0.5291784 0.4565576 0.5176469 0.09328493 0.237768
2 0.3777376 0.3821031 0.5291784 0.4565576 0.5176469 0.09328493 0.237768
3 0.3777376 0.3821031 0.5291784 0.4565576 0.5176469 0.09328493 0.237768
4 0.3777376 0.3821031 0.5291784 0.4565576 0.5176469 0.09328493 0.237768
5 0.3777376 0.3821031 0.5291784 0.4565576 0.5176469 0.09328493 0.237768
6 0.3777376 0.3821031 0.5291784 0.4565576 0.5176469 0.09328493 0.237768
     C0702    C0704    C0706    C0718     C0801      C0802     C0803    C0804
1 0.237768 0.237768 0.237768 0.237768 0.5739617 0.08644861 0.2260879 0.529322
2 0.237768 0.237768 0.237768 0.237768 0.5739617 0.08644861 0.2260879 0.529322
3 0.237768 0.237768 0.237768 0.237768 0.5739617 0.08644861 0.2260879 0.529322
4 0.237768 0.237768 0.237768 0.237768 0.5739617 0.08644861 0.2260879 0.529322
5 0.237768 0.237768 0.237768 0.237768 0.5739617 0.08644861 0.2260879 0.529322
6 0.237768 0.237768 0.237768 0.237768 0.5739617 0.08644861 0.2260879 0.529322
       C1202     C1203     C1402     C1403     C1502     C1504     C1505
1 0.08831536 0.3069367 0.1931956 0.2686138 0.1548501 0.2009604 0.1480181
2 0.08831536 0.3069367 0.1931956 0.2686138 0.1548501 0.2009604 0.1480181
3 0.08831536 0.3069367 0.1931956 0.2686138 0.1548501 0.2009604 0.1480181
4 0.08831536 0.3069367 0.1931956 0.2686138 0.1548501 0.2009604 0.1480181
5 0.08831536 0.3069367 0.1931956 0.2686138 0.1548501 0.2009604 0.1480181
6 0.08831536 0.3069367 0.1931956 0.2686138 0.1548501 0.2009604 0.1480181
      C1601     C1602     C1604     C1701
1 0.3540573 0.3540573 0.3540573 0.3728518
2 0.3540573 0.3540573 0.3540573 0.3728518
3 0.3540573 0.3540573 0.3540573 0.3728518
4 0.3540573 0.3540573 0.3540573 0.3728518
5 0.3540573 0.3540573 0.3540573 0.3728518
6 0.3540573 0.3540573 0.3540573 0.3728518
> 
> 
> corr_pos = matrix(NA, ncol = dim(df_pos)[2], nrow = dim(df_pos)[2])
> corr_pos[dim(df_pos)[2], dim(df_pos)[2]] = 1
> 
> for (i in 1:(dim(df_pos)[2]-1)){
+     corr_pos[i, i] = 1
+   for (j in (i+1):(dim(df_pos)[2])){
+     x = as.numeric(df_pos[, i])
+     y = as.numeric(df_pos[, j])
+     corr_pos[i, j] = cor(x, y, method = c("spearman"))
+     corr_pos[j, i] = corr_pos[i, j]
+   }
+ }
> 
> dist_pos = 1 - corr_pos
> 
> summary(c(dist_pos))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.2508  0.6076  0.6855  1.0454  1.8034 
> 
> colnames(dist_pos) = colnames(df_pos)
> 
> 
> write.csv(as.data.frame(dist_pos), 
+           file = "../results/st9_Glazer_2022_server_on_Zheng_2021_pos_HLA_I_dist.csv", 
+           row.names = FALSE)
> 
> 
> gc()
          used (Mb) gc trigger (Mb) limit (Mb) max used (Mb)
Ncells  363137 19.4     667037 35.7         NA   667037 35.7
Vcells 2364121 18.1    8388608 64.0      65536  8388607 64.0
> 
> sessionInfo()
R version 4.1.0 (2021-05-18)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.1.0
> q(save="no")
> proc.time()
   user  system elapsed 
 21.968   2.220  24.189 
