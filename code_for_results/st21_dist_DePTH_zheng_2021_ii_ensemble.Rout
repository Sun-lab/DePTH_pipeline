
R version 4.1.0 (2021-05-18) -- "Camp Pontanezen"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> # this code computes distance matrices for HLAs
> 
> 
> HLA_filepath = "../data/Liu_2019/liu_2019_hla_ii_format.csv"
> df_HLA = read.csv(HLA_filepath, header = TRUE)
> dim(df_HLA)
[1] 141   1
> 
> # distance based on positive TCRs from single cell data
> 
> pos_filename = "st20_HLA_II_zheng_2021_ensemble_reshape_20.csv" 
> df_pos = read.csv(paste0("../results/", pos_filename), header = TRUE)
> dim(df_pos)
[1] 6547  141
> head(df_pos)
  HLA.DPAB.01.03_01.01 HLA.DPAB.01.03_02.01 HLA.DPAB.01.03_03.01
1            0.9162613             0.926451            0.9375778
2            0.9162613             0.926451            0.9375778
3            0.9162613             0.926451            0.9375778
4            0.9162613             0.926451            0.9375778
5            0.9162613             0.926451            0.9375778
6            0.9162613             0.926451            0.9375778
  HLA.DPAB.01.03_04.01 HLA.DPAB.01.03_04.02 HLA.DPAB.01.03_13.01
1             0.948547            0.9371259            0.9386127
2             0.948547            0.9371259            0.9386127
3             0.948547            0.9371259            0.9386127
4             0.948547            0.9371259            0.9386127
5             0.948547            0.9371259            0.9386127
6             0.948547            0.9371259            0.9386127
  HLA.DPAB.01.03_17.01 HLA.DPAB.02.01_01.01 HLA.DPAB.02.01_02.01
1            0.8878335            0.8877552            0.9084715
2            0.8878335            0.8877552            0.9084715
3            0.8878335            0.8877552            0.9084715
4            0.8878335            0.8877552            0.9084715
5            0.8878335            0.8877552            0.9084715
6            0.8878335            0.8877552            0.9084715
  HLA.DPAB.02.01_03.01 HLA.DPAB.02.01_04.01 HLA.DPAB.02.01_04.02
1            0.9057068            0.9262356            0.9156317
2            0.9057068            0.9262356            0.9156317
3            0.9057068            0.9262356            0.9156317
4            0.9057068            0.9262356            0.9156317
5            0.9057068            0.9262356            0.9156317
6            0.9057068            0.9262356            0.9156317
  HLA.DPAB.02.01_05.01 HLA.DPAB.02.01_13.01 HLA.DPAB.02.01_17.01
1            0.8328089            0.9117208            0.8588665
2            0.8328089            0.9117208            0.8588665
3            0.8328089            0.9117208            0.8588665
4            0.8328089            0.9117208            0.8588665
5            0.8328089            0.9117208            0.8588665
6            0.8328089            0.9117208            0.8588665
  HLA.DPAB.02.02_01.01 HLA.DPAB.02.02_04.01 HLA.DPAB.02.02_04.02
1            0.8716746            0.9162746            0.9069775
2            0.8716746            0.9162746            0.9069775
3            0.8716746            0.9162746            0.9069775
4            0.8716746            0.9162746            0.9069775
5            0.8716746            0.9162746            0.9069775
6            0.8716746            0.9162746            0.9069775
  HLA.DQAB.01.01_02.01 HLA.DQAB.01.01_02.02 HLA.DQAB.01.01_03.01
1            0.9130178            0.9130178            0.8511099
2            0.9130178            0.9130178            0.8511099
3            0.9130178            0.9130178            0.8511099
4            0.9130178            0.9130178            0.8511099
5            0.9130178            0.9130178            0.8511099
6            0.9130178            0.9130178            0.8511099
  HLA.DQAB.01.01_03.02 HLA.DQAB.01.01_03.03 HLA.DQAB.01.01_04.02
1            0.8813361            0.8659672             0.914813
2            0.8813361            0.8659672             0.914813
3            0.8813361            0.8659672             0.914813
4            0.8813361            0.8659672             0.914813
5            0.8813361            0.8659672             0.914813
6            0.8813361            0.8659672             0.914813
  HLA.DQAB.01.01_05.01 HLA.DQAB.01.01_06.02 HLA.DQAB.01.01_06.03
1            0.8993484            0.8806481            0.8692093
2            0.8993484            0.8806481            0.8692093
3            0.8993484            0.8806481            0.8692093
4            0.8993484            0.8806481            0.8692093
5            0.8993484            0.8806481            0.8692093
6            0.8993484            0.8806481            0.8692093
  HLA.DQAB.01.01_06.04 HLA.DQAB.01.02_02.01 HLA.DQAB.01.02_02.02
1            0.8900812            0.9165586            0.9165586
2            0.8900812            0.9165586            0.9165586
3            0.8900812            0.9165586            0.9165586
4            0.8900812            0.9165586            0.9165586
5            0.8900812            0.9165586            0.9165586
6            0.8900812            0.9165586            0.9165586
  HLA.DQAB.01.02_03.01 HLA.DQAB.01.02_03.02 HLA.DQAB.01.02_03.03
1              0.85325            0.8800247            0.8619492
2              0.85325            0.8800247            0.8619492
3              0.85325            0.8800247            0.8619492
4              0.85325            0.8800247            0.8619492
5              0.85325            0.8800247            0.8619492
6              0.85325            0.8800247            0.8619492
  HLA.DQAB.01.02_05.01 HLA.DQAB.01.02_05.02 HLA.DQAB.01.02_05.03
1            0.8910272            0.8766434            0.8766271
2            0.8910272            0.8766434            0.8766271
3            0.8910272            0.8766434            0.8766271
4            0.8910272            0.8766434            0.8766271
5            0.8910272            0.8766434            0.8766271
6            0.8910272            0.8766434            0.8766271
  HLA.DQAB.01.02_06.01 HLA.DQAB.01.02_06.02 HLA.DQAB.01.02_06.03
1            0.8434483             0.874303            0.8597606
2            0.8434483             0.874303            0.8597606
3            0.8434483             0.874303            0.8597606
4            0.8434483             0.874303            0.8597606
5            0.8434483             0.874303            0.8597606
6            0.8434483             0.874303            0.8597606
  HLA.DQAB.01.02_06.04 HLA.DQAB.01.02_06.09 HLA.DQAB.01.03_02.01
1            0.8833626            0.8856411             0.882209
2            0.8833626            0.8856411             0.882209
3            0.8833626            0.8856411             0.882209
4            0.8833626            0.8856411             0.882209
5            0.8833626            0.8856411             0.882209
6            0.8833626            0.8856411             0.882209
  HLA.DQAB.01.03_02.02 HLA.DQAB.01.03_03.01 HLA.DQAB.01.03_03.02
1             0.882209            0.8173035            0.8455705
2             0.882209            0.8173035            0.8455705
3             0.882209            0.8173035            0.8455705
4             0.882209            0.8173035            0.8455705
5             0.882209            0.8173035            0.8455705
6             0.882209            0.8173035            0.8455705
  HLA.DQAB.01.03_04.02 HLA.DQAB.01.03_05.01 HLA.DQAB.01.03_05.02
1            0.8808962            0.8756829            0.8550326
2            0.8808962            0.8756829            0.8550326
3            0.8808962            0.8756829            0.8550326
4            0.8808962            0.8756829            0.8550326
5            0.8808962            0.8756829            0.8550326
6            0.8808962            0.8756829            0.8550326
  HLA.DQAB.01.03_05.03 HLA.DQAB.01.03_06.01 HLA.DQAB.01.03_06.02
1            0.8585534             0.817418            0.8542036
2            0.8585534             0.817418            0.8542036
3            0.8585534             0.817418            0.8542036
4            0.8585534             0.817418            0.8542036
5            0.8585534             0.817418            0.8542036
6            0.8585534             0.817418            0.8542036
  HLA.DQAB.01.03_06.03 HLA.DQAB.01.03_06.04 HLA.DQAB.01.03_06.09
1            0.8368483            0.8634755            0.8626974
2            0.8368483            0.8634755            0.8626974
3            0.8368483            0.8634755            0.8626974
4            0.8368483            0.8634755            0.8626974
5            0.8368483            0.8634755            0.8626974
6            0.8368483            0.8634755            0.8626974
  HLA.DQAB.01.04_02.01 HLA.DQAB.01.04_03.01 HLA.DQAB.01.04_05.03
1            0.9130178            0.8511099            0.8832806
2            0.9130178            0.8511099            0.8832806
3            0.9130178            0.8511099            0.8832806
4            0.9130178            0.8511099            0.8832806
5            0.9130178            0.8511099            0.8832806
6            0.9130178            0.8511099            0.8832806
  HLA.DQAB.01.04_06.01 HLA.DQAB.01.04_06.02 HLA.DQAB.01.05_02.01
1            0.8410469            0.8806481            0.9130178
2            0.8410469            0.8806481            0.9130178
3            0.8410469            0.8806481            0.9130178
4            0.8410469            0.8806481            0.9130178
5            0.8410469            0.8806481            0.9130178
6            0.8410469            0.8806481            0.9130178
  HLA.DQAB.01.05_05.01 HLA.DQAB.02.01_02.01 HLA.DQAB.02.01_02.02
1            0.8993484            0.9486866            0.9486866
2            0.8993484            0.9486866            0.9486866
3            0.8993484            0.9486866            0.9486866
4            0.8993484            0.9486866            0.9486866
5            0.8993484            0.9486866            0.9486866
6            0.8993484            0.9486866            0.9486866
  HLA.DQAB.02.01_03.01 HLA.DQAB.02.01_03.02 HLA.DQAB.02.01_03.03
1             0.876003            0.8766217            0.8905871
2             0.876003            0.8766217            0.8905871
3             0.876003            0.8766217            0.8905871
4             0.876003            0.8766217            0.8905871
5             0.876003            0.8766217            0.8905871
6             0.876003            0.8766217            0.8905871
  HLA.DQAB.02.01_04.02 HLA.DQAB.02.01_05.01 HLA.DQAB.02.01_05.02
1            0.9238587            0.8969481            0.8807673
2            0.9238587            0.8969481            0.8807673
3            0.9238587            0.8969481            0.8807673
4            0.9238587            0.8969481            0.8807673
5            0.9238587            0.8969481            0.8807673
6            0.9238587            0.8969481            0.8807673
  HLA.DQAB.02.01_06.01 HLA.DQAB.02.01_06.02 HLA.DQAB.02.01_06.03
1             0.868177            0.9110187            0.8759359
2             0.868177            0.9110187            0.8759359
3             0.868177            0.9110187            0.8759359
4             0.868177            0.9110187            0.8759359
5             0.868177            0.9110187            0.8759359
6             0.868177            0.9110187            0.8759359
  HLA.DQAB.03.01_02.02 HLA.DQAB.03.01_03.01 HLA.DQAB.03.01_03.02
1            0.9230707             0.897025            0.9044847
2            0.9230707             0.897025            0.9044847
3            0.9230707             0.897025            0.9044847
4            0.9230707             0.897025            0.9044847
5            0.9230707             0.897025            0.9044847
6            0.9230707             0.897025            0.9044847
  HLA.DQAB.03.01_05.01 HLA.DQAB.03.01_05.02 HLA.DQAB.03.01_06.02
1            0.8848134            0.8697277            0.8884023
2            0.8848134            0.8697277            0.8884023
3            0.8848134            0.8697277            0.8884023
4            0.8848134            0.8697277            0.8884023
5            0.8848134            0.8697277            0.8884023
6            0.8848134            0.8697277            0.8884023
  HLA.DQAB.03.01_06.03 HLA.DQAB.03.01_06.04 HLA.DQAB.03.02_02.01
1            0.8662632            0.8820289            0.9230707
2            0.8662632            0.8820289            0.9230707
3            0.8662632            0.8820289            0.9230707
4            0.8662632            0.8820289            0.9230707
5            0.8662632            0.8820289            0.9230707
6            0.8662632            0.8820289            0.9230707
  HLA.DQAB.03.02_03.03 HLA.DQAB.03.03_02.01 HLA.DQAB.03.03_02.02
1            0.8996463            0.9230707            0.9230707
2            0.8996463            0.9230707            0.9230707
3            0.8996463            0.9230707            0.9230707
4            0.8996463            0.9230707            0.9230707
5            0.8996463            0.9230707            0.9230707
6            0.8996463            0.9230707            0.9230707
  HLA.DQAB.03.03_03.01 HLA.DQAB.03.03_03.02 HLA.DQAB.03.03_04.02
1             0.897025            0.9044847            0.9289277
2             0.897025            0.9044847            0.9289277
3             0.897025            0.9044847            0.9289277
4             0.897025            0.9044847            0.9289277
5             0.897025            0.9044847            0.9289277
6             0.897025            0.9044847            0.9289277
  HLA.DQAB.03.03_05.01 HLA.DQAB.03.03_05.02 HLA.DQAB.03.03_06.02
1            0.8848134            0.8697277            0.8884023
2            0.8848134            0.8697277            0.8884023
3            0.8848134            0.8697277            0.8884023
4            0.8848134            0.8697277            0.8884023
5            0.8848134            0.8697277            0.8884023
6            0.8848134            0.8697277            0.8884023
  HLA.DQAB.03.03_06.03 HLA.DQAB.04.01_02.02 HLA.DQAB.04.01_03.01
1            0.8662632            0.8818951            0.8544288
2            0.8662632            0.8818951            0.8544288
3            0.8662632            0.8818951            0.8544288
4            0.8662632            0.8818951            0.8544288
5            0.8662632            0.8818951            0.8544288
6            0.8662632            0.8818951            0.8544288
  HLA.DQAB.04.01_04.02 HLA.DQAB.04.01_05.01 HLA.DQAB.04.01_06.03
1            0.8753604            0.8633238            0.8303735
2            0.8753604            0.8633238            0.8303735
3            0.8753604            0.8633238            0.8303735
4            0.8753604            0.8633238            0.8303735
5            0.8753604            0.8633238            0.8303735
6            0.8753604            0.8633238            0.8303735
  HLA.DQAB.05.01_02.01 HLA.DQAB.05.01_02.02 HLA.DQAB.05.01_03.01
1            0.9198264            0.9198264            0.9102419
2            0.9198264            0.9198264            0.9102419
3            0.9198264            0.9198264            0.9102419
4            0.9198264            0.9198264            0.9102419
5            0.9198264            0.9198264            0.9102419
6            0.9198264            0.9198264            0.9102419
  HLA.DQAB.05.01_03.03 HLA.DQAB.05.01_05.01 HLA.DQAB.05.01_05.03
1            0.8904342            0.8949674            0.8991311
2            0.8904342            0.8949674            0.8991311
3            0.8904342            0.8949674            0.8991311
4            0.8904342            0.8949674            0.8991311
5            0.8904342            0.8949674            0.8991311
6            0.8904342            0.8949674            0.8991311
  HLA.DQAB.05.01_06.02 HLA.DQAB.05.01_06.03 HLA.DQAB.05.05_02.01
1            0.9059943            0.8675587            0.9198264
2            0.9059943            0.8675587            0.9198264
3            0.9059943            0.8675587            0.9198264
4            0.9059943            0.8675587            0.9198264
5            0.9059943            0.8675587            0.9198264
6            0.9059943            0.8675587            0.9198264
  HLA.DQAB.05.05_02.02 HLA.DQAB.05.05_03.01 HLA.DQAB.05.05_03.02
1            0.9198264            0.9102419            0.8755939
2            0.9198264            0.9102419            0.8755939
3            0.9198264            0.9102419            0.8755939
4            0.9198264            0.9102419            0.8755939
5            0.9198264            0.9102419            0.8755939
6            0.9198264            0.9102419            0.8755939
  HLA.DQAB.05.05_03.03 HLA.DQAB.05.05_04.02 HLA.DQAB.05.05_05.01
1            0.8904342             0.917653            0.8949674
2            0.8904342             0.917653            0.8949674
3            0.8904342             0.917653            0.8949674
4            0.8904342             0.917653            0.8949674
5            0.8904342             0.917653            0.8949674
6            0.8904342             0.917653            0.8949674
  HLA.DQAB.05.05_05.02 HLA.DQAB.05.05_05.03 HLA.DQAB.05.05_06.01
1             0.880714            0.8991311            0.9015913
2             0.880714            0.8991311            0.9015913
3             0.880714            0.8991311            0.9015913
4             0.880714            0.8991311            0.9015913
5             0.880714            0.8991311            0.9015913
6             0.880714            0.8991311            0.9015913
  HLA.DQAB.05.05_06.02 HLA.DRB1.01.01 HLA.DRB1.01.02 HLA.DRB1.03.01
1            0.9059943      0.8980514      0.8532869      0.9534132
2            0.9059943      0.8980514      0.8532869      0.9534132
3            0.9059943      0.8980514      0.8532869      0.9534132
4            0.9059943      0.8980514      0.8532869      0.9534132
5            0.9059943      0.8980514      0.8532869      0.9534132
6            0.9059943      0.8980514      0.8532869      0.9534132
  HLA.DRB1.04.01 HLA.DRB1.04.02 HLA.DRB1.04.04 HLA.DRB1.04.05 HLA.DRB1.04.07
1      0.9208287      0.8505809      0.9063361      0.8714967      0.8866013
2      0.9208287      0.8505809      0.9063361      0.8714967      0.8866013
3      0.9208287      0.8505809      0.9063361      0.8714967      0.8866013
4      0.9208287      0.8505809      0.9063361      0.8714967      0.8866013
5      0.9208287      0.8505809      0.9063361      0.8714967      0.8866013
6      0.9208287      0.8505809      0.9063361      0.8714967      0.8866013
  HLA.DRB1.07.01 HLA.DRB1.08.01 HLA.DRB1.08.04 HLA.DRB1.09.01 HLA.DRB1.10.01
1      0.9428173      0.8215936      0.8336114      0.8912928      0.8870497
2      0.9428173      0.8215936      0.8336114      0.8912928      0.8870497
3      0.9428173      0.8215936      0.8336114      0.8912928      0.8870497
4      0.9428173      0.8215936      0.8336114      0.8912928      0.8870497
5      0.9428173      0.8215936      0.8336114      0.8912928      0.8870497
6      0.9428173      0.8215936      0.8336114      0.8912928      0.8870497
  HLA.DRB1.11.01 HLA.DRB1.11.03 HLA.DRB1.11.04 HLA.DRB1.12.01 HLA.DRB1.13.01
1      0.8889541      0.8729623      0.8765859      0.8305398      0.8742922
2      0.8889541      0.8729623      0.8765859      0.8305398      0.8742922
3      0.8889541      0.8729623      0.8765859      0.8305398      0.8742922
4      0.8889541      0.8729623      0.8765859      0.8305398      0.8742922
5      0.8889541      0.8729623      0.8765859      0.8305398      0.8742922
6      0.8889541      0.8729623      0.8765859      0.8305398      0.8742922
  HLA.DRB1.13.02 HLA.DRB1.13.03 HLA.DRB1.14.01 HLA.DRB1.14.04 HLA.DRB1.14.54
1      0.8869075      0.8468202      0.8967631      0.8926024      0.8967631
2      0.8869075      0.8468202      0.8967631      0.8926024      0.8967631
3      0.8869075      0.8468202      0.8967631      0.8926024      0.8967631
4      0.8869075      0.8468202      0.8967631      0.8926024      0.8967631
5      0.8869075      0.8468202      0.8967631      0.8926024      0.8967631
6      0.8869075      0.8468202      0.8967631      0.8926024      0.8967631
  HLA.DRB1.15.01 HLA.DRB1.15.02 HLA.DRB1.16.01
1      0.8711085      0.8818888      0.8148765
2      0.8711085      0.8818888      0.8148765
3      0.8711085      0.8818888      0.8148765
4      0.8711085      0.8818888      0.8148765
5      0.8711085      0.8818888      0.8148765
6      0.8711085      0.8818888      0.8148765
> 
> stopifnot(dim(df_HLA)[1] == dim(df_pos)[2])
> 
> corr_pos = matrix(NA, ncol = dim(df_pos)[2], nrow = dim(df_pos)[2])
> corr_pos[dim(df_pos)[2], dim(df_pos)[2]] = 1
> 
> for (i in 1:(dim(df_pos)[2]-1)){
+     corr_pos[i, i] = 1
+   for (j in (i+1):(dim(df_pos)[2])){
+     x = as.numeric(df_pos[, i])
+     y = as.numeric(df_pos[, j])
+     corr_pos[i, j] = cor(x, y, method = c("spearman"))
+     corr_pos[j, i] = corr_pos[i, j]
+   }
+ }
> 
> dist_pos = 1 - corr_pos
> 
> summary(c(dist_pos))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00000 0.01559 0.02614 0.02937 0.04071 0.10957 
> 
> colnames(dist_pos) = colnames(df_pos)
> 
> 
> write.csv(as.data.frame(dist_pos), 
+           file = "../results/st21_zheng_2021_pos_HLA_II_dist_ensemble_20.csv", 
+           row.names = FALSE)
> 
> 
> gc()
          used (Mb) gc trigger (Mb) limit (Mb) max used (Mb)
Ncells  367245 19.7    1274311 68.1         NA  1154530 61.7
Vcells 2548861 19.5    8388608 64.0      65536  8386504 64.0
> 
> sessionInfo()
R version 4.1.0 (2021-05-18)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.1.0
> q(save="no")
> proc.time()
   user  system elapsed 
 16.610   0.337  16.948 
